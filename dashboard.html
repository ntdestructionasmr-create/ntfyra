<!DOCTYPE html>
<html>
<head>
  <title>NTFYRA Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    .tabs { display:flex; gap:8px; margin-bottom:16px; }
    .tab {
      flex:1; padding:12px; border:none; border-radius:14px;
      background:#eef1f4; cursor:pointer; transition:.3s;
      font-size:14px;
    }
    .tab.active {
      background:#00c853; color:#fff;
      box-shadow:0 8px 18px rgba(0,200,83,.3);
    }
    .section { display:none; animation:fade .3s ease; }
    .section.active { display:block; }
    @keyframes fade { from{opacity:0; transform:translateY(8px)} to{opacity:1} }
    .box {
      background:#f4f6f9; padding:14px;
      border-radius:14px; margin-bottom:14px;
    }
    .hidden { display:none; }
    .workout-day {
      background:#fff; padding:10px;
      border-radius:10px; margin-bottom:8px;
      border:1px solid #e6e9ee;
    }
    .ai-box {
      background:#e8f5e9;
      border-left:5px solid #00c853;
      padding:14px; border-radius:12px;
      font-size:14px;
    }
    .modal {
      position:fixed; inset:0;
      background:rgba(0,0,0,.5);
      display:flex; align-items:center; justify-content:center;
    }
    .modal-box {
      background:#fff; padding:20px;
      border-radius:14px; max-width:300px;
      text-align:center;
    }
  </style>
</head>

<body>

<script>
  let isPremium = localStorage.getItem("premium") === "true";
  let hasExperienced = localStorage.getItem("experienced") === "true";
</script>

<div class="container">
  <h1>Dashboard</h1>

  <!-- TABS -->
  <div class="tabs">
    <button class="tab active" onclick="openTab('user',this)">User</button>
    <button class="tab" onclick="openTab('workout',this)">Workouts</button>
    <button class="tab" onclick="openTab('progress',this)">Progress</button>
    <button class="tab" onclick="openPremium('ai',this)">AI Coach ðŸ”’</button>
  </div>

  <!-- USER -->
  <div id="user" class="section active">
    <div class="box">
      <label>Weight (kg)</label>
      <input type="number" id="weight">

      <label>Workout Type</label>
      <select id="workoutType" onchange="checkWorkout()">
        <option value="">Select</option>
        <option value="home">Home</option>
        <option value="gym">Gym</option>
      </select>

      <div id="gymBox" class="hidden">
        <label>Gym Level</label>
        <select id="gymLevel">
          <option value="beginner">Beginner</option>
          <option value="advanced">Advanced</option>
        </select>
      </div>

      <button onclick="generateWorkout()">Generate Workout</button>
    </div>
  </div>

  <!-- WORKOUT -->
  <div id="workout" class="section">
    <div class="box" id="workoutContent">
      Generate workout from User tab.
    </div>
  </div>

  <!-- PROGRESS -->
  <div id="progress" class="section">
    <div class="box">
      <input type="number" id="todayWeight" placeholder="Today's weight">
      <button onclick="addProgress()">Add</button>
    </div>
    <div class="box">
      <canvas id="weightChart"></canvas>
    </div>
  </div>

  <!-- AI COACH -->
  <div id="ai" class="section">
    <div class="ai-box" id="aiAdvice">
      Unlock AI Coach for smart suggestions ðŸš€
    </div>
  </div>
</div>

<!-- PREMIUM MODAL -->
<div id="premiumModal" class="modal hidden">
  <div class="modal-box">
    <h3>Upgrade to Premium ðŸš€</h3>
    <p>Unlock AI Coach, advanced workouts & unlimited tracking.</p>
    <p><b>â‚¹99 / month</b></p>
    <button onclick="unlockPremium()">Upgrade Now</button>
    <br><br>
    <button onclick="closePremium()">Later</button>
  </div>
</div>

<script>
/* ---------- TABS ---------- */
function openTab(id, btn){
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById(id).classList.add('active');
}

/* ---------- PREMIUM ACCESS ---------- */
function openPremium(id, btn){
  if(!isPremium && !hasExperienced){
    alert("Try workouts & progress first ðŸ™‚");
    return;
  }
  if(!isPremium && hasExperienced){
    document.getElementById("premiumModal").classList.remove("hidden");
    return;
  }
  openTab(id, btn);
}

function closePremium(){
  document.getElementById("premiumModal").classList.add("hidden");
}

function unlockPremium(){
  localStorage.setItem("premium","true");
  isPremium = true;
  closePremium();
  alert("Premium unlocked ðŸŽ‰");
}

/* ---------- WORKOUT ---------- */
function checkWorkout(){
  workoutType.value==="gym"
    ? gymBox.classList.remove("hidden")
    : gymBox.classList.add("hidden");
}

function generateWorkout(){
  const type = workoutType.value;
  const level = gymLevel.value;

  localStorage.setItem("experienced","true");
  hasExperienced = true;

  if(type==="gym" && level==="advanced" && !isPremium){
    workoutContent.innerHTML="ðŸ”’ Advanced workouts available in Premium.";
    return;
  }

  let plan="";
  if(type==="home"){
    plan=`
      <div class="workout-day">Mon â€“ Full Body</div>
      <div class="workout-day">Tue â€“ Cardio</div>
      <div class="workout-day">Wed â€“ Core</div>
      <div class="workout-day">Thu â€“ Strength</div>
      <div class="workout-day">Fri â€“ Cardio</div>`;
  } else {
    plan = level==="beginner"
      ? `<div class="workout-day">Chest</div>
         <div class="workout-day">Back</div>
         <div class="workout-day">Legs</div>
         <div class="workout-day">Shoulders</div>`
      : `<div class="workout-day">Heavy Chest</div>
         <div class="workout-day">Heavy Back</div>
         <div class="workout-day">Heavy Legs</div>
         <div class="workout-day">Arms</div>`;
  }

  workoutContent.innerHTML=plan;
  document.querySelectorAll('.tab')[1].click();
}

/* ---------- PROGRESS ---------- */
let weights = JSON.parse(localStorage.getItem("weights")||"[]");

function addProgress(){
  if(!isPremium && weights.length>=3){
    document.getElementById("premiumModal").classList.remove("hidden");
    return;
  }
  const w = Number(todayWeight.value);
  if(!w) return;
  weights.push(w);
  localStorage.setItem("weights",JSON.stringify(weights));
  todayWeight.value="";
  drawChart();
  generateAI();
}

function drawChart(){
  new Chart(weightChart,{
    type:'line',
    data:{
      labels:weights.map((_,i)=>`Day ${i+1}`),
      datasets:[{data:weights,borderColor:'#00c853',tension:.4}]
    },
    options:{plugins:{legend:{display:false}}}
  });
}

/* ---------- AI COACH ---------- */
function generateAI(){
  if(!isPremium){
    aiAdvice.innerHTML="Upgrade to Premium to get AI suggestions ðŸš€";
    return;
  }
  if(weights.length<3){
    aiAdvice.innerHTML="Add at least 3 entries for analysis.";
    return;
  }
  const diff = weights[weights.length-1] - weights[weights.length-3];
  let msg="";
  if(diff>0.8) msg="Great progress ðŸ’ª Keep it up!";
  else if(diff>0.2) msg="Progress slow. Increase calories by 200 kcal.";
  else msg="No progress. Eat more & reduce cardio.";
  aiAdvice.innerHTML=msg;
}

drawChart(); generateAI();
</script>

</body>
</html>
